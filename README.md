#Inherited Retinal Dystrophy Genome Analysis (IRDGA) Pipleline
This repository accompanies the work **“A Comprehensive Phenotype Driven Genome Analysis Pipeline for Novel Variant and Gene Discovery”**(2025).

## 🧬 Project Overview

This project implements and validates a two-phase variant analysis pipeline combining:

- **Panel-Gene Analysis (PGA)** — phenotype-driven, targeted gene set analysis for known IRD genes.
- **Whole Genome Analysis (WGA)** — genome-wide discovery of variants (SNVs, indels, SVs) with a flexible scoring system integrating multiple in silico predictors.

This approach improves diagnostic yield by prioritizing non-coding and structural variants frequently missed by standard pipelines.

## 🧬 Files Overview

This repository contains **R Markdown (`.Rmd`)** files. 

> **Note:** `.Rmd` files are best run within **RStudio**, which provides an interactive environment for editing and rendering them. Although it is possible to render `.Rmd` files from the command line using `rmarkdown::render()`, they are not executable scripts in the same way `.R` files are. Users are welcome to adapt these workflows into `.R` scripts if they prefer a command-line interface.

## 📂 File Inputs

This pipeline accepts variant call files generated by **The Centre for Applied Genomics (TCAG)** at The Hospital for Sick Children (SickKids). Users may order next-generation sequencing (NGS) services directly from TCAG and run these files through the pipeline.  
Alternatively, users can process their own sequencing data but must ensure that input files match the expected column structure and nomenclature to prevent errors during downstream filtering. Always verify VCF or tabular format consistency before execution.

## ⚙️ Repository Contents

| File                               | Description                            |
| ---------------------------------- | -------------------------------------- |
| `WGA_SNV.Rmd`                 | Whole Genome SNV analysis        |
| `WGA_SV.Rmd`                  | Whole Genome SV analysis         |
| `PGA_SNV.Rmd`                 | Panel-Gene SNV analysis         |
| `PGA_SV.Rmd`                  | Panel-Gene SV analysis           |
| `InheritanceFilter.Rmd`             | Inheritance Pattern (AR, AD) Filtering |

Each script processes variant call files and outputs prioritized candidate variants for interpretation.
> **Note:** The file names given above do not include Build (hg37/38) or date/version. Only InheritanceFilter.Rmd can be used on all versions of files.

## 📂 File Inputs  

This pipeline accepts variant call files generated by **The Centre for Applied Genomics (TCAG)** at The Hospital for Sick Children (SickKids).  

These files have consistent formatting and annotations optimized for the filtering steps implemented in the pipeline.  

**However, you may also use your own annotated files**—for example, variants called in-house, through another sequencing core, or by independent analysis—**provided that all required columns are present and correctly named.**  

If column names differ, you will need to rename them in your input file (or adjust mappings in the code).  

---

### 1️⃣ SNV Files (Small Nucleotide Variants & Indels)  

The expected input is the **TCAG SNV TSV file**.  
Custom tabular formats (`.tsv`, `.csv`, `.xlsx`) are supported if the required columns are present.  

**Recommended annotation tools for custom SNV files:**  
- **ANNOVAR** — for functional annotations (`effect_priority`, `typeseq_priority`, `Clinvar_SIG`, `Clinvar_ReviewStatus`, etc.)  
- **CADD v1.6** — for `CADD_phred`  
- **SpliceAI** — for `spliceAI_DS_AG/AL/DG/DL`  
- **MPO/HPO Ontologies** — for phenotype annotations (`MPO`, `HPO`)  

**Required SNV Columns**  
*(must match exactly; same for GRCh37 & GRCh38)*  

| Column Name          | Purpose                                                                 |
|----------------------|-------------------------------------------------------------------------|
| `gene_symbol`        | Variant gene assignment, grouping                                       |
| `FILTER`             | Quality control (“PASS” required)                                       |
| `AD_ALT`, `AD_REF`   | Alternate and reference read depth                                      |
| `1000g_all`* OR `A1000g_freq_max` OR `freq_max` | Population frequency filtering (≤0.5% threshold) |
| `typeseq_priority`   | Variant functional class filtering                                      |
| `spliceAI_DS_AG`, `spliceAI_DS_AL`, `spliceAI_DS_DG`, `spliceAI_DS_DL` | Splice prediction scoring |
| `Clinvar_SIG`        | ClinVar pathogenicity                                                   |
| `Clinvar_ReviewStatus` | ClinVar review confidence                                             |
| `effect_priority`    | Variant effect (frameshift, stopgain, stoploss, etc.)                   |
| `sift_score`         | SIFT score                                                              |
| `polyphen_score`     | PolyPhen2 score                                                         |
| `ma_score`           | Mutation Assessor score                                                 |
| `spx_dpsi`           | SPIDEX ΔΨ splicing prediction                                           |
| `phylopMam_avg`      | PhyloP mammalian conservation                                          |
| `phylopVert100_avg`  | PhyloP vertebrate conservation                                         |
| `PROVEAN_score`      | PROVEAN pathogenicity                                                  |
| `CADD_phred`         | CADD Phred-scaled pathogenicity                                        |
| `REVEL_score` (*hg38 ONLY!*)  | REVEL Score                                 |
| `MPO`   | Mammalian Phenotype Ontology terms                                     |
| `HPO` | Human Phenotype Ontology terms                                         |

---

### 2️⃣ SV Files (Structural Variants)  

The expected input is the **TCAG structural variant output** (.tsv).  
Custom SV sets from MANTA, CNVnator, DELLY, etc. are supported if the required columns are present. Columns in this code do not need to be named exactly as shown below as the code will ask the user to identify the columns upon execution; just make sure the information exists.

> ⚠ **Population frequency filtering** may not run for non-TCAG SV files if frequency columns are missing. You can add your own population frequency annotations (e.g., 1000 Genomes, gnomAD-SV) and update column names in the code.  

**Required SV Columns**  

| Column Name   | Purpose                                    |
|---------------|--------------------------------------------|
| `CHROM`       | Chromosome identifier                      |
| `gene_symbol` | Gene(s) overlapping the SV                 |
| `Start`       | Start position of SV                       |
| `Stop`        | End position of SV                         |
 
---

### 3️⃣ Inheritance Filtering File  

The inheritance filtering stage requires **only a `gene_symbol` column**.  
---

## 🏷️ Key Features

✅ Integrated SNV, indel, and SV filtering  
✅ Flexible scoring using SIFT, PolyPhen2, REVEL, CADD, SpliceAI, and others  
✅ Customizable for AR and AD inheritance modes  
✅ Supports cross-variant merging for compound heterozygosity detection  
✅ Versions for GRCh37 (hg19) and GRCh38 (hg38) genome builds

## 🧑‍🔬 Intended Use

This pipeline is designed for research use in IRD gene discovery and diagnostic resolution of unsolved cases. Panel-gene lists should be tailored to each proband’s phenotype and clinical data.

## 📄 Requirements

- R (≥ 4.0)
- R packages: `tidyverse`, `data.table`, `vcfR`, `VariantAnnotation`, `GenomicRanges`, `plyr`, etc.
- High-quality GS data (VCF/BAM) with proper annotations

## 🚀 Getting Started

1. Clone the repository (or just download the required scripts!)
2. Edit either the `.Rmd` scripts to match your data paths and gene panels, or vice versa.
3. Run in RStudio.
4. Review output files, merge SNV and SV results, and prioritize candidates.
> ⚠ **Confused?** Feel free to look at the How to Use Folder for a walkthrough. 


## 🤝 Acknowledgements

Developed under the supervision of the Dr. Ajoy Vincent Lab, The Hospital for Sick Children, Toronto. 
Genome sequencing conducted by: The Centre for Applied Genomics (TCAG).


Please cite this work if you use or adapt this pipeline:

> Ahmed L. *et al.*, *A Comprehensive Phenotype Driven Genome Analysis Pipeline for Novel Variant and Gene Discovery*
---

For questions or contributions, please feel free to get in touch with the corresponding author.
